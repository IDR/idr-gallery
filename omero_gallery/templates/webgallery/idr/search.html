
{% extends "webgallery/idr/base.html" %}

{% block content %}

<hr class="whitespace" style="height: 0">

<div class="row column text-center">
  <h1>Welcome to {% if idr_type %}{{ idr_type|title }} {% endif %} IDR</h1>

<div class="small-10 small-centered medium-10 medium-centered columns">

    <div class="row horizontal">

      <div class="small-12 medium-12 large-2 columns">
        <h2>Search by:</h2>
      </div>
      <div class="small-12 medium-4 large-3 columns">
        <select id="maprConfig">
          <optgroup id="studyKeys" label="Study Attributes">
            <!-- Map-Annotation keys loaded here -->
          </optgroup>
          <optgroup id="maprKeys" label="Image Attributes">
          </optgroup>
        </select>
      </div>
      <div class="small-12 medium-8 large-7 columns">
        <input id="maprQuery" type="text" placeholder="Publication Authors">
      </div>
    </div>

    <div id="filterCount" class="row horizontal">
    </div>
</div>

<div id="studies" class="row horizontal">
  Loading Studies...

  <script>
    function studyHtml(props) {
      return `
      <a target="_blank" href="${ props.studyLink }">
        <div class="studyBackground" style="padding: 0">
          <img class="studyImage" src="${ props.studyThumbUrl }" />
        </div>
        <div class="studyText">
          <p title="${ props.studyDesc }">
            <span style='color:#1976d2'>${ props.idrId }</span>:
            ${ props.title }
          </p>
        </div>
        <div class="studyAuthors">
          ${ props.authors }
        </div>
      </a>
      <a class="viewerLink" title="Open image in viewer" target="_blank"
         href="${ props.BASE_URL }/webclient/img_detail/${ props.imgId }/">
        <i class="fas fa-eye"></i>
      </a>
      `
    }

    function maprHtml(props, data) {
      return `
      <a target="_blank" href="${ props.studyLink }">
        
        <div id="${ props.type }-${ data['@id'] }" class="maprText">
          <p>Found ${ data.imageCount } images in study:</p>
          <p title="${ props.studyDesc }">
            <span style='color:#1976d2'>${ props.idrId }</span>:
            ${ props.title }
          </p>
        </div>
      </a>
      `
    }
  </script>
</div>


<script>
  // Various global constants from bin/omero config set...
  const IDR_TYPE = "{{ idr_type }}";
  const BASE_URL = "{{ base_url }}";
  const CATEGORY_QUERIES = {{ category_queries|escape|safe }};
</script>

<script src="{% static 'gallery/idr/search.js' %}"></script>

{% endblock %}
